// raylib [shapes] example - bouncing ball (Disturb port)
// Source: shapes/shapes_bouncing_ball.c

eval(read("examples_raylib_port/common.dist"));
name = "shapes_bouncing_ball";
if (port_has_display() == 0) {
  cv = beginOffscreenColor(160, 90, PORT_RAYWHITE);
  x = 30;
  y = 30;
  vx = 2;
  vy = 1;
  i = 0;
  while (i < 30) {
    x = x + vx;
    y = y + vy;
    if (x > 150 || x < 10) { vx = -vx; }
    if (y > 80 || y < 10) { vy = -vy; }
    i = i + 1;
  }
  offscreenDrawCircle(cv, x, y, 6, PORT_MAROON);
  if (assertPixelEquals(name, cv, x, y, PORT_MAROON) == 1) {
    port_pass_headless(name);
  }
}
else {
  port_window_begin(800, 450, "raylib shapes: bouncing ball");
  x = 120.0;
  y = 120.0;
  vx = 3.0;
  vy = 2.5;
  r = 20.0;
  frame = 0;
  while (raylib_phase3.rl2_WindowShouldClose() == 0 && frame < 150) {
    frame = frame + 1;
    x = x + vx;
    y = y + vy;
    if (x > 780.0 || x < 20.0) { vx = -vx; }
    if (y > 430.0 || y < 20.0) { vy = -vy; }

    raylib_phase3.rl2_BeginDrawing();
    raylib_phase3.rl2_ClearBackground(PORT_RAYWHITE);
    raylib_phase3.rl2_DrawCircleV(x, y, r, PORT_MAROON);
    raylib_phase3.rl2_DrawText("bouncing ball", 20, 20, 20, PORT_DARKGRAY);
    raylib_phase3.rl2_EndDrawing();
  }
  port_window_end();
  port_pass_windowed(name);
}
